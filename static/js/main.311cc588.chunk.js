(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{130:function(e,t){},133:function(e,t,a){},134:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(10),i=a.n(s),o=a(11),c=a(12),l=a(9),p=a(14),m=a(13),u=a(177),h=a(136),d=a(165),g=a(166),f=a(167),b=a(168),v=a(176),y=a(169),E=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={name:"",error:!1,helperText:"",loading:!0},n.nameChangeHandler=n.nameChangeHandler.bind(Object(l.a)(n)),n.submitHandler=n.submitHandler.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.setState({loading:!1})}),1500)}},{key:"nameChangeHandler",value:function(e){var t=e.target.value;this.setState({name:t}),""!==t.trim()&&!0===this.state.error&&this.setState({error:!1,helperText:""})}},{key:"submitHandler",value:function(e){return e.preventDefault(),console.log(this.state.name),""===this.state.name.trim()?this.setState({error:!0,helperText:"You must enter a name."}):this.props.play(this.state.name),!1}},{key:"render",value:function(){return r.a.createElement(u.a,{maxWidth:"md",padding:"10vh"},r.a.createElement(h.a,{elevation:3},r.a.createElement(u.a,{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"400px",height:"60vh"},this.state.loading?r.a.createElement(u.a,{display:"flex",alignItems:"center",justifyContent:"center"},r.a.createElement(d.a,{size:90})):r.a.createElement(g.a,{in:!this.state.loading},r.a.createElement("form",{onSubmit:this.submitHandler},r.a.createElement(f.a,{spacing:8,container:!0,direction:"column",alignItems:"center"},r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(b.a,{variant:"h1"},"Type Away")),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(u.a,{width:300},r.a.createElement(v.a,{fullWidth:!0,helperText:this.state.helperText,error:this.state.error,label:"Name",variant:"filled",required:!0,onChange:this.nameChangeHandler}))),r.a.createElement(f.a,{item:!0,xs:12},r.a.createElement(y.a,{type:"submit"},"Continue"))))))))}}]),a}(n.Component),k=a(52),j=a.n(k),O=a(170),S=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).props=e,n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(u.a,{display:"flex",flexDirection:"column",alignItems:"center"},r.a.createElement(u.a,{alignItems:"center",display:"flex"},r.a.createElement(b.a,{align:"center",variant:"body1"},this.props.player.name),this.props.player.gameLeader&&r.a.createElement(j.a,null),r.a.createElement(u.a,{component:"span",marginLeft:1},r.a.createElement(b.a,{align:"center",variant:"body1"}," ","".concat(this.props.player.speed," WPM")))),r.a.createElement(u.a,{width:"200px"},r.a.createElement(O.a,{variant:"determinate",value:this.props.player.progress})))}}]),a}(n.Component),w=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).props=e,n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(u.a,{height:"470px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},r.a.createElement(b.a,{variant:"h6"},"PLAYERS"),this.props.players.filter((function(e){return!1===e.spectator})).sort((function(e,t){return t.speed-e.speed})).map((function(e){return r.a.createElement(S,{player:e,key:e.id})})),this.props.self&&this.props.self.spectator&&!this.props.gameStarted?r.a.createElement(y.a,{onClick:this.props.toggleSpectator,variant:"contained",color:"secondary"},"Join as player"):"",r.a.createElement(b.a,{variant:"h6"},"SPECTATORS"),this.props.players.filter((function(e){return!0===e.spectator})).map((function(e){return r.a.createElement(b.a,{variant:"body1",key:e.id},e.name)})),!this.props.self||this.props.self.spectator||this.props.gameStarted?"":r.a.createElement(y.a,{onClick:this.props.toggleSpectator,variant:"contained",color:"secondary"},"Join as spectator")))}}]),a}(n.Component),x=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={showStart:!1},n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(u.a,{p:2},this.props.loading&&r.a.createElement(d.a,{size:90}),this.props.showStart?r.a.createElement(y.a,{variant:"contained",color:"primary",onClick:this.props.startClick},"Start Game"):r.a.createElement(b.a,{align:"center",variant:"body1"},"Please wait for the game leader."))}}]),a}(n.Component),C=a(79),T=a.n(C);function M(){this.time=0,this.callback=null}M.prototype.start=function(){var e=this;this.interval=setInterval((function(){e.time+=1,e.callback&&e.callback(e.time)}),1e3)},M.prototype.stop=function(){clearInterval(this.interval)},M.prototype.reset=function(){this.time=0},M.prototype.onTick=function(e){this.callback=e};var W=M,I=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).message=r.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.message.current.scrollIntoView({behavior:"smooth"})}},{key:"render",value:function(){return r.a.createElement(u.a,{ref:this.message,border:"1px solid black",m:1,p:1},r.a.createElement(b.a,{variant:"subtitle1"},this.props.message.name),r.a.createElement(b.a,{variant:"body2"},this.props.message.content),r.a.createElement(b.a,{variant:"body2"},new Date(this.props.message.time).toLocaleTimeString()))}}]),a}(n.Component),H=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={message:""},n.updateHandler=n.updateHandler.bind(Object(l.a)(n)),n.send=n.send.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"send",value:function(e){e.preventDefault(),this.props.sendMessage(this.state.message),this.setState({message:""})}},{key:"updateHandler",value:function(e){var t=e.target.value;this.setState({message:t})}},{key:"render",value:function(){var e=this;return r.a.createElement(u.a,{height:"100%"},this.props.loading?r.a.createElement(u.a,{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},r.a.createElement(d.a,{size:90})):r.a.createElement(u.a,null,r.a.createElement(u.a,{display:"flex",flexDirection:"column",height:"500px",overflow:"auto"},this.props.messages.map((function(t,a){return r.a.createElement(I,{ref:function(t){e.messagesEnd=t},key:a,message:t})}))),r.a.createElement(u.a,{marginTop:1},r.a.createElement("form",{onSubmit:this.send},r.a.createElement(v.a,{fullWidth:!0,variant:"outlined",label:"Chat",value:this.state.message,onChange:this.updateHandler})))))}}]),a}(n.Component),D=a(80),P=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={words:0,excerptArr:e.excerpt.match(/\S+/g),totalWords:0,count:3},n.textInput=r.a.createRef(),n.updateParent=n.updateParent.bind(Object(l.a)(n)),n.disallowMultipleSpace=n.disallowMultipleSpace.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.setState({count:e.state.count-1}),0===e.state.count&&(clearInterval(e.interval),e.props.startTimer(),e.textInput.current.focus())}),1e3)}},{key:"updateParent",value:function(e){var t=this,a=this.props.excerpt.match(/\S+/g),n=e.target.innerHTML.replace(/&nbsp;/," ").match(/\S+/g);if(n){this.setState({totalWords:n.length});for(var r=Object(D.a)(n),s=n.length;s>=0;s--){console.log("comparing ",r[s]," to ",a[s]),r[s]!==a[s]&&r.splice(s,1)}this.setState({words:r.length},(function(){return t.props.update(t.state.words)})),console.log("words: ",n.length," excerpt: ",a.length),(n.length>a.length||r[r.length-1]===a[a.length-1])&&this.props.finish()}else this.setState({words:0});console.log("excerpt: ",a),console.log(n)}},{key:"disallowMultipleSpace",value:function(e){if(32===e.which&&e.target.innerHTML.endsWith("nbsp;"))return e.preventDefault(),!1}},{key:"render",value:function(){return r.a.createElement(u.a,{className:"Background",p:3},this.state.count>0?r.a.createElement(b.a,{variant:"h2"},this.state.count):r.a.createElement(b.a,{variant:"body1"},r.a.createElement(u.a,{component:"span",color:"primary.main"},this.state.excerptArr.slice(0,this.state.totalWords).join(" "))," ",r.a.createElement(u.a,{component:"span",color:"secondary.main"},this.state.excerptArr.slice(this.state.totalWords,this.state.excerptArr.length).join(" ")),r.a.createElement(u.a,{p:1,minHeight:20,ref:this.textInput,onKeyDown:this.disallowMultipleSpace,onKeyUp:this.updateParent,className:"typebox",contentEditable:"true",style:{border:"1px solid black"}})))}}]),a}(n.Component),G=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={excerpt:"",words:0,time:0},n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(u.a,{height:"100%"},this.props.start?r.a.createElement(P,{startTimer:this.props.startTimer,update:this.props.updateWords,finish:this.props.stopGame,excerpt:this.props.excerpt}):r.a.createElement(H,{sendMessage:this.props.sendMessage,messages:this.props.messages,loading:this.props.loading,error:this.props.error}))}}]),a}(n.Component),L=a(44),A=a.n(L);function N(e){var t="";switch(e.type){case"server":t="There was an error connecting to the server. Try again later.";break;default:t="There was an error. Please try again later."}return r.a.createElement(u.a,{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},r.a.createElement(b.a,{variant:"body1"},t),r.a.createElement("div",null,r.a.createElement(y.a,{size:"medium",variant:"contained",startIcon:r.a.createElement(A.a,null),color:"primary","aria-label":"menu",onClick:e.back},"Back to Home")))}var J=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement(b.a,{variant:"body1"},"Time: ",this.props.time),r.a.createElement(b.a,{variant:"body1"},"Correct Words: ",this.props.words),r.a.createElement(b.a,{variant:"body1"},"WPM: ",Math.round(60*this.props.words/this.props.time)))}}]),a}(n.Component),B=a(171),R=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).name="",n.timer=new W,n.socket=null,n.state={gameLeader:!1,showStart:!1,showWait:!1,start:!1,time:0,words:0,excerpt:"",error:!1,loading:!0,players:[],spectators:[],self:{},messages:[]},n.listenToMessages=n.listenToMessages.bind(Object(l.a)(n)),n.startTimer=n.startTimer.bind(Object(l.a)(n)),n.startClick=n.startClick.bind(Object(l.a)(n)),n.updateWords=n.updateWords.bind(Object(l.a)(n)),n.stopGame=n.stopGame.bind(Object(l.a)(n)),n.errorOut=n.errorOut.bind(Object(l.a)(n)),n.toggleSpectator=n.toggleSpectator.bind(Object(l.a)(n)),n.sendMessage=n.sendMessage.bind(Object(l.a)(n)),n.sendUpdates=n.sendUpdates.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"errorOut",value:function(){this.setState({error:!0,loading:!1}),this.socket.close()}},{key:"listenToMessages",value:function(){var e=this;this.socket=T()("https://8cce5b506ebb.ngrok.io",{timeout:5e3}),this.socket.emit("join",this.props.name),this.socket.on("connect",(function(){console.log("Connected!"),e.setState({loading:!1})})),this.socket.on("connect_error",(function(){console.log("Sorry, there seems to be an issue with the connection!"),e.errorOut()})),this.socket.on("playerchange",(function(t){var a=JSON.parse(t),n=a.players.find((function(t){return t.id===e.socket.id}));n||(n=a.spectators.find((function(t){return t.id===e.socket.id}))),console.log("self",n),e.setState({players:a.players,spectators:a.spectators,self:n,showStart:n.gameLeader&&!e.state.start})})),this.socket.on("gamestarted",(function(t){var a=JSON.parse(t);e.setState({excerpt:a.excerpt,players:a.players,spectators:a.spectators,start:!0,showStop:!0,words:0})})),this.socket.on("gameupdate",(function(t){var a=JSON.parse(t);e.setState({players:a.players})})),this.socket.on("gamefinished",(function(t){e.socket.id===t&&e.setState({showStart:!0}),e.setState({showWait:!1})})),this.socket.on("message",(function(t){console.log("message received: ",t);var a=e.state.messages.concat(t);e.setState({messages:a})}))}},{key:"componentDidMount",value:function(){var e=this;this.listenToMessages(),this.timer.onTick((function(t){e.setState({time:t})}))}},{key:"sendUpdates",value:function(){var e=this;this.interval=setInterval((function(){e.socket.emit("update",{time:e.state.time,words:e.state.words})}),500)}},{key:"startClick",value:function(){this.socket.emit("startgame"),this.setState({showStart:!1})}},{key:"startTimer",value:function(){this.timer.start(),this.sendUpdates()}},{key:"stopGame",value:function(){this.setState({start:!1,showStop:!1,showWait:!0}),this.timer.stop(),clearInterval(this.interval),this.socket.emit("playerfinish",{words:this.state.words,time:this.state.time}),this.timer.reset(),this.setState({time:0})}},{key:"toggleSpectator",value:function(){this.socket.emit("togglespectator")}},{key:"updateWords",value:function(e){this.setState({words:e})}},{key:"sendMessage",value:function(e){this.socket.emit("message",{content:e,time:Date.now()})}},{key:"render",value:function(){return r.a.createElement(B.a,null,r.a.createElement(u.a,{marginTop:"50px"},r.a.createElement(f.a,{container:!0,spacing:2},r.a.createElement(f.a,{item:!0,xs:9},r.a.createElement(h.a,null,r.a.createElement(u.a,{p:2,height:"564px"},this.state.error?r.a.createElement(N,{type:"server",back:this.props.back}):r.a.createElement(G,{startTimer:this.startTimer,sendMessage:this.sendMessage,messages:this.state.messages,start:this.state.start,loading:this.state.loading,updateWords:this.updateWords,excerpt:this.state.excerpt,stopGame:this.stopGame})))),r.a.createElement(f.a,{item:!0,xs:3},r.a.createElement(u.a,null,r.a.createElement(w,{gameStarted:this.state.start,toggleSpectator:this.toggleSpectator,self:this.state.self,players:this.state.players,spectators:this.state.spectators})),r.a.createElement(u.a,{marginTop:"16px"},r.a.createElement(h.a,null,r.a.createElement(u.a,{height:"110px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},this.state.start?r.a.createElement(J,{words:this.state.words,time:this.state.time}):r.a.createElement(x,{showStart:this.state.showStart,startClick:this.startClick,gameStarted:this.state.start}))))))))}}]),a}(n.Component),U=a(172),z=a(173),K=a(174),Y=a(175),q=Object(U.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function V(){var e=q();return r.a.createElement(z.a,{position:"static"},r.a.createElement(K.a,null,r.a.createElement(Y.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(A.a,null)),r.a.createElement(b.a,{variant:"h6",className:e.title},"Type Away")))}a(133);var $=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={play:!1},n.play=n.play.bind(Object(l.a)(n)),n.back=n.back.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"play",value:function(e){this.name=e,console.log("Let's play,",e),this.setState({play:!0})}},{key:"back",value:function(){this.setState({play:!1})}},{key:"render",value:function(){return r.a.createElement(u.a,{height:"100%",bgcolor:"primary.dark"},r.a.createElement(V,null),this.state.play?r.a.createElement(R,{name:this.name,back:this.back}):r.a.createElement(E,{play:this.play}))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},91:function(e,t,a){e.exports=a(134)}},[[91,1,2]]]);
//# sourceMappingURL=main.311cc588.chunk.js.map